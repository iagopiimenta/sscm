!function(){"use strict";angular.element(document).ready(function(){document.getElementsByTagName("body")[0].style.display="block"}),angular.module("app",["ngMessages"]),angular.module("app").directive("animateOnChange",["$animate","$timeout",function(a,b){return function(c,d,e){c.$watchCollection(e.animateOnChange,function(c,e){return c?(a.addClass(d,"info"),void a.addClass(d,"changed").then(function(){a.addClass(d,"info"),b(function(){a.removeClass(d,"changed")},0)})):void a.removeClass(d,"info")})}}]),angular.module("app").controller("MemoryController",["$scope","$timeout",function(a,b){a.finishJob=!0,a.logs=[],a.setup={mainMemorySize:32,mainMemoryBlockSize:2,memoryCacheNumberLines:8,memoryCacheN:2,sequenceBlocks:"0 1 2 3 4 5 0 6"},a.dirtyAndInvalidClass=function(b){return(a.setupForm[b].$dirty||a.setupForm[b].$touched)&&a.setupForm[b].$invalid?"has-error":void 0},a.$watchGroup(["setup.memoryCacheNumberLines","setup.memoryCacheN"],function(a,b){c()});var c=function(){a.setupForm.memoryCacheNumberLines.$valid&&a.setupForm.memoryCacheN.$valid&&(a.lines=new Array(a.setup.memoryCacheNumberLines),a.groupLines=new Array(Math.ceil(a.setup.memoryCacheNumberLines/a.setup.memoryCacheN)),a.numberLinesEachGroup=new Array(a.setup.memoryCacheN))};a.$watchGroup(["setup.mainMemorySize","setup.mainMemoryBlockSize"],function(a,b){d()});var d=function(){if(a.setupForm.mainMemorySize.$valid&&a.setupForm.mainMemoryBlockSize.$valid){var b=Math.ceil(a.setup.mainMemorySize/a.setup.mainMemoryBlockSize);a.blocks&&a.blocks.length==b||(a.blocks=new Array(b))}};a.canShowLineBlock=function(b,c){var d=a.lines[b*a.numberLinesEachGroup.length+c];return d&&"undefined"!=typeof d.block},a.isEmptyMainMemory=function(){return!a.blocks||0==a.blocks.length},a.isEmptyMemoryCache=function(){return!a.lines||0==a.lines.length},a.lineByGroupAndLineGroupNumber=function(b,c){return a.lines[b*a.numberLinesEachGroup.length+c]},a.currentLine=function(b,c){var d=a.lines[b*a.numberLinesEachGroup.length+c];return d?d:{}},a.runSequence=function(a){e(),a.runOnceAllBlocks?g():h()},a.restart=function(){a.configured=!1,a.sequence=[],a.blocks=[],a.lines=[],a.logs=[],c(),d()};var e=function(){a.configured||(a.sequence=a.formatSequence(),a.configured=!0)};a.formatSequence=function(){var b=a.setup.sequenceBlocks.split(" ");if(null==a.setup.sequenceBlocks.match(/[^(\d| )]/g))return f(b)};var f=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=parseInt(a[b]);return a},g=function(){a.finishJob&&a.getFromMC(a.sequence.shift()),a.sequence.length>0&&b(g,200)},h=function(){a.finishJob&&(a.getFromMC(a.sequence.shift()),0==a.sequence.length?a.emptySequence=!0:a.emptySequence=!1)};a.getFromMC=function(c){a.finishJob=!1;for(var d=c%a.groupLines.length,e=d*a.numberLinesEachGroup.length,f=(d+1)*a.numberLinesEachGroup.length,g=-1,h=Number.MAX_VALUE,j=-1,k=e;f>k;k++)if(a.lines[k]){if(a.lines[k].block==c)return a.logs.push({block:c,group:d,groupLine:k-e,line:k,type:"exist"}),i(1e3),a.lines[k].usedAt=performance.now();h>a.lines[k].usedAt&&(h=a.lines[k].usedAt,j=k)}else g=g>-1?g:k;a.cursor={blockNumber:c,notUsedIndex:g,leastRecentlyUsedIndex:j},a.blocks[c]={usedAt:performance.now()},b(a.addBlockToMC,1e3)},a.addBlockToMC=function(){if(a.cursor.notUsedIndex>-1){var b=a.cursor.notUsedIndex/a.numberLinesEachGroup.length,c=a.cursor.notUsedIndex%a.numberLinesEachGroup.length;a.logs.push({block:a.cursor.blockNumber,group:Math.floor(b),groupLine:c,line:a.cursor.notUsedIndex,type:"allocated"}),a.lines[a.cursor.notUsedIndex]={usedAt:performance.now(),block:a.cursor.blockNumber}}else{var b=a.cursor.leastRecentlyUsedIndex/a.numberLinesEachGroup.length,c=a.cursor.leastRecentlyUsedIndex%a.numberLinesEachGroup.length;a.logs.push({block:a.cursor.blockNumber,group:Math.floor(b),groupLine:c,line:a.cursor.leastRecentlyUsedIndex,type:"overwritten",oldBlock:a.lines[a.cursor.leastRecentlyUsedIndex].block}),a.lines[a.cursor.leastRecentlyUsedIndex]={usedAt:performance.now(),block:a.cursor.blockNumber}}i(1e3)};var i=function(c){b(function(){a.finishJob=!0},c)}}])}();